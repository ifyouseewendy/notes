## the Standard RESTful Controller and Actions

1. The default request method is **GET**.
2. In a **form_tag** or **form_for** call, the **POST** method will be used automatically.
3. When you need to (which is going to be mostly with **PUT** and **DELETE** operations),
  you can specify a request method along with the URL generated by the named route.

  ```ruby
  link_to "Delete", auction_path(auction), :method => :delete

  form_for "auction", :url => auction_path(auction),
           :html => { :method => :put } do |f| }
  ```

## The PUT and DELETE Cheat

A **PUT** or **DELETE** request originating in a browser, in the context of REST in
Rails, **is actually a POST request with a hidden field called _method set to either "put"
or "delete"**. The Rails application processing the request will pick up on this, and
route the request appropriately to the **update** or **destroy** action.

## Nested Resources

> Resources should never be nested more than one level deep. - Jamis Buck

```ruby
resources :auctions do
  resources :bids do
    resources :comments
  end
end

resources :auctions do
  resources :bids
end
resources :bids do
  resources :comments
end
resources :comments

auctions_path         # /auctions
auctions_path(1)      # /auctions/1
auction_bids_path(1)  # /auctions/1/bids
bid_path(2)           # /bids/2
bid_comments_path(3)  # /bids/3/comments
comment_path(4)       # /comments/4
```

**Shallow Routes**

resource routes accept a :shallow option that helps to shorten URLs
where possible. The goal is to leave off parent collection URL segments where they are
not needed. The end result is that the only nested routes generated are for the **:index**,
**:create**, and **:new** actions. The rest are kept in their own shallow URL context.

```ruby
resources :auctions, :shallow => true do
  resources :bids do
    resources :comments
  end
end

resources :auctions do
  shallow do
    resources :bids do
      resources :comments
    end
  end
end
```

```ruby
                GET       /auctions(.:format)
       auctions POST      /auctions(.:format)
    new_auction GET       /auctions/new(.:format)
                GET       /auctions/:id(.:format)
                PUT       /auctions/:id(.:format)
        auction DELETE    /auctions/:id(.:format)
   edit_auction GET       /auctions/:id/edit(.:format)
                GET       /auctions/:auction_id/bids(.:format)
   auction_bids POST      /auctions/:auction_id/bids(.:format)
new_auction_bid GET       /auctions/:auction_id/bids/new(.:format)
                GET       /bids/:bid_id/comments(.:format)
   bid_comments POST      /bids/:bid_id/comments(.:format)
new_bid_comment GET       /bids/:bid_id/comments/new(.:format
                GET       /comments/:id(.:format)
                PUT       /comments/:id(.:format)
        comment DELETE    /comments/:id(.:format)
   edit_comment GET       /comments/:id/edit(.:format)
```

## RESTful Route Customizations

```ruby
resources :auctions do
  resources :bids do
    member do
      get :retract
    end
  end
end

link_to "Retract", retract_bid_path(auction, bid)
```

Custom Action Names

```ruby
resources :reports, :path_names => { :new => 'nuevo', :edit => 'cambiar'}

new_report GET /reports/nuevo(.:format)
edit_report GET /reports/:id/cambiar(.:format)
```

Mapping to a Different Controller

```ruby
resources :photos, :controller => "images"
```

Routes for New Resources

```ruby
resources :reports do
  new do
    post :preview
  end
end

preview_new_report POST /reports/new/preview(.:format)
{:action=>"preview", :controller=>"reports"}
```

## Different Representations of Resources

**respond_to**

```ruby
def index
  @auctions = Auction.all
  respond_to do |format|
    format.html
    format.xml { render :xml => @auctions }
  end
end
```

**respond_with**

```ruby
class AuctionsController < ApplicationController
  respond_to :html, :xml, :json
  def index
    @auctions = Auction.all
    respond_with(@auctions)
  end
end
```

+ Attempt to render the associated view with a **.json** extension
+ If no view exists, call **to_json** on the object passed to **responds_with**.
+ If the object does not respond to **to_json**, call **to_format** on it.

Formatted Named Routes

```ruby
link_to "XML version of this auction", auction_path(@auction, :xml)

<a href="/auctions/1.xml">XML version of this auction</a>
```
